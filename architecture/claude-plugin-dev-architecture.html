<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Revised Architecture — Claude Plugin for Accelerating Development</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    background: #0d1117;
    color: #c9d1d9;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
    padding: 24px;
  }
  h1 { font-size: 1.4rem; margin-bottom: 8px; color: #e6edf3; }
  .subtitle { font-size: 0.9rem; color: #8b949e; margin-bottom: 24px; }
  .diagram-container {
    background: #161b22;
    border: 1px solid #30363d;
    border-radius: 8px;
    padding: 24px;
    overflow-x: auto;
  }
  .legend {
    margin-top: 20px;
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
    font-size: 0.85rem;
  }
  .legend-item { display: flex; align-items: center; gap: 6px; }
  .legend-swatch { width: 14px; height: 14px; border-radius: 3px; }
  .swatch-new { background: #2ecc71; }
  .swatch-existing { background: #3498db; }
  .swatch-data { background: #f39c12; }
</style>
</head>
<body>
<h1>Revised Architecture — Claude Plugin for Accelerating Development</h1>
<p class="subtitle">Generated by /review-architecture on 2026-02-27</p>
<div class="diagram-container">
  <pre class="mermaid">
graph TB
    classDef new fill:#238636,stroke:#238636,color:#fff
    classDef existing fill:#1f6feb,stroke:#1f6feb,color:#fff
    classDef datastore fill:#9e6a03,stroke:#9e6a03,color:#fff

    subgraph Presentation["Presentation Tier"]
        WebUI["Web UI\nNext.js 15\nnode:22-alpine\nPort 3001"]:::new
        Auth["Keycloak Auth\nquay.io/keycloak/keycloak:26.0\nPort 8080"]:::new
    end

    subgraph ClaudeEcosystem["Claude Ecosystem"]
        Claude["Claude\nAnthropic API\nclaude-opus-4-0-20250115"]:::existing

        subgraph PluginSkills["Plugin Skills\n.claude/skills/"]
            StrategySkill["Strategy Review\nSKILL.md"]:::new
            GenderTechSkill["Gender Tech Review\nSKILL.md"]:::new
            BudgetSkill["Budget Review\nSKILL.md"]:::new
        end

        subgraph SubAgents["Sub-Agents\n.claude/agents/"]
            GraphAgent["Graph Traversal\nAgent\nclaude-sonnet-4-20250514"]:::new
            SearchAgent["Document Search\nAgent\nclaude-sonnet-4-20250514"]:::new
            ImageAgent["Image Retrieval\nAgent\nclaude-sonnet-4-20250514"]:::new
        end

        subgraph MCPServers["MCP Servers"]
            Neo4jMCP["Neo4j MCP Server\n@neo4j/mcp-neo4j\nstdio transport"]:::new
            StrategyMCP["Strategy Review\nMCP Server\nPython FastMCP\nstdio transport"]:::existing
        end
    end

    subgraph DataTier["Data Tier"]
        Neo4j["Neo4j\nneo4j:5.26-community\nPorts 7474, 7687"]:::datastore
        OpenSearch["Azure AI Search\nProd: Azure AI Search\nDev: opensearch:2.17.0\nPort 9200"]:::datastore
        Azurite["Blob Storage\nProd: Azure Blob\nDev: azurite:3.33.0\nPort 10000"]:::datastore
    end

    WebUI -->|"OIDC Auth Flow"| Auth
    WebUI -->|"Authenticated API calls\nstreaming responses"| Claude

    Claude -->|"Invokes skill\nbased on topic"| StrategySkill
    Claude -->|"Invokes skill\nbased on topic"| GenderTechSkill
    Claude -->|"Invokes skill\nbased on topic"| BudgetSkill

    StrategySkill -->|"Task tool\ndispatches to"| GraphAgent
    StrategySkill -->|"Task tool\ndispatches to"| SearchAgent
    StrategySkill -->|"Task tool\ndispatches to"| ImageAgent
    GenderTechSkill -->|"Task tool\ndispatches to"| GraphAgent
    GenderTechSkill -->|"Task tool\ndispatches to"| SearchAgent
    BudgetSkill -->|"Task tool\ndispatches to"| GraphAgent
    BudgetSkill -->|"Task tool\ndispatches to"| SearchAgent

    GraphAgent -->|"mcp__neo4j__query\nmcp__neo4j__get_schema"| Neo4jMCP
    SearchAgent -->|"mcp__strategy_review__search_docs\nmcp__strategy_review__search_chunks"| StrategyMCP
    ImageAgent -->|"mcp__strategy_review__get_page_image"| StrategyMCP

    Neo4jMCP -->|"Bolt protocol\nCypher queries"| Neo4j
    StrategyMCP -->|"REST API\nBM25 + vector + RRF"| OpenSearch
    StrategyMCP -->|"REST API\nBlob retrieval by\ndoc_id + page"| Azurite
  </pre>
</div>
<div class="legend">
  <div class="legend-item"><span class="legend-swatch swatch-new"></span> New components</div>
  <div class="legend-item"><span class="legend-swatch swatch-existing"></span> Existing components</div>
  <div class="legend-item"><span class="legend-swatch swatch-data"></span> Data stores</div>
</div>
<script type="module">
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
  mermaid.initialize({
    startOnLoad: true,
    theme: 'dark',
    themeVariables: {
      darkMode: true,
      background: '#161b22',
      primaryColor: '#1f6feb',
      primaryTextColor: '#e6edf3',
      primaryBorderColor: '#388bfd',
      lineColor: '#8b949e',
      secondaryColor: '#238636',
      tertiaryColor: '#21262d',
      fontSize: '14px'
    },
    flowchart: { htmlLabels: true, curve: 'basis', padding: 15, nodeSpacing: 40, rankSpacing: 60 }
  });
</script>
</body>
</html>
